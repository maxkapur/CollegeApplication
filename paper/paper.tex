%!TEX encoding = UTF-8 Unicode 

\documentclass[11pt]{article} %try amsproc, amsart
\usepackage{geometry}       \geometry{a4paper, margin=2.5cm}
\usepackage{setspace}       \setstretch{1.1}
\usepackage{hyperref}       \hyperbaseurl{}    
                            \urlstyle{same}
\usepackage[ruled,linesnumbered]{algorithm2e}   \SetKwInOut{KwParams}{Parameters}
                                                \newcommand{\lIfElse}[3]{\lIf{#1}{#2 \textbf{else}~#3}}
\usepackage{stackengine}    \newcommand\xrowht[2][0]{\addstackgap[.5\dimexpr#2\relax]{\vphantom{#1}}}

% Author block
\usepackage{authblk}

\title{Complexity analysis and a fully polynomial-time approximation scheme for the college application problem}
\author[1]{Max Kapur}
\author[2]{Sung-Pil Hong}
\affil[1,2]{Department of Industrial Engineering, Seoul National University}
\date{\today}




% Math
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{proposition}{Proposition}
\theoremstyle{definition}
\newtheorem{example}{Example}
\newtheorem{definition}{Definition}
\newtheorem{problem}{Problem}
\newtheorem{assumption}{Assumption}
\newtheorem{conjecture}{Conjecture}

%\numberwithin{equation}{section}
%\numberwithin{theorem}{section}
%\numberwithin{lemma}{section}
%\numberwithin{corollary}{section}
%\numberwithin{proposition}{section}
%\numberwithin{example}{section}
%\numberwithin{definition}{section}
%\numberwithin{problem}{section}
%\numberwithin{assumption}{section}
%\numberwithin{conjecture}{section}


\begin{document}

\maketitle


\begin{abstract}
The college application problem is a submodular optimization problem involving the maximization of the expected maximum value of a portfolio of random variables subject to a budget constraint. We introduce this problem, show that it is NP-complete, and provide two optimization algorithms based on dynamic programming. A modification of the second dynamic program yields a fully polynomial-time approximation scheme.

\textbf{Keywords:} submodular maximization, knapsack problems, approximation algorithms

\vfill
Correspondence may be addressed to Max Kapur.
\begin{itemize}
%\item[] Correspondence may be addressed to Max Kapur.

\item[] Email: \url{maxkapur@gmail.com}

\item[] Address: 39-411, 1 Gwanak-ro, Gwanak-gu, Seoul 08826, Republic of Korea
\end{itemize}

\end{abstract}


\pagebreak

\tableofcontents










\section{Introduction}

This paper considers the following optimization problem:
\begin{align} \label{headlineproblem}
\begin{split}
\text{maximize}\quad &  v(\mathcal{X}) =
 \operatorname{E}\Bigl[\max\bigr\{t_0,
\max\{t_j Z_j : j \in \mathcal{X}\}\bigr\}\Bigr] \\
\text{subject to}\quad & \mathcal{X} \subseteq \mathcal{C}, ~~\sum_{j\in \mathcal{X}} g_j \leq H
\end{split}
\end{align}
Here $\mathcal{C} = \{ 1 \dots m\}$ is an index set; $H > 0$ is a budget parameter; for $j = 1 \dots m$, $g_j > 0$ is a cost parameter and $Z_j$ is a random, independent Bernoulli variable with probability $f_j$; and for $j = 0\dots m$, $t_j\geq 0$ is a utility parameter.

We refer to this problem as the \emph{optimal college application} problem, as follows. Consider an admissions market with $m$ colleges. Consider a single prospective student in this market, and let each $t_j$-value indicate the utility she associates with attending school $j$, where her utility is $t_0$ if she does not attend college. Let $g_j$ denote the application fee for school $j$ and $H$ the student's total budget to spend on application fees. Lastly, let $f_j$ denote the student's probability of being admitted to school $j$ if she applies, so that $Z_j$ equals one if she is admitted and zero if not. The student's objective is to maximize the expected utility associated with the best school she gets into within this budget. Therefore, her optimal college application strategy is given by the solution $\mathcal{X}$ to the problem above, where $\mathcal{X}$ represents the set of schools to which she applies. 

The problem is also conformable to other competitive matching games such as job application. Here, the budget constraint may represent the time needed to complete each application, or a legal limit on the number of applications permitted.

\subsection{Literature review}

The objective function of the college application problem is a nondecreasing, submodular set function in the sense first described by Nemhauser, Wolsey, and Fisher (1978). Nemhauser and Wolsey (1978) showed that a polynomial-time algorithm for maximizing such a function over a knapsack constraint cannot achieve an approximation ratio better than $1 - 1 / e \approx 0.632$. Subsequent research in submodular maximization has discovered a variety of algorithms that achieve this approximation ratio using a variety of relaxation techniques (Chekuri et al. 2014; Badanidiyuru and Vondrák 2014; Kulik et al. 2013).

The college application problem is NP-complete, meaning that it cannot be solved in polynomial time unless P=NP. However, the existence of a fully polynomial-time approximation scheme (FPTAS) for the college application problem suggests that it is a relatively easy instance of submodular maximization. For a maximization problem, an FPTAS is defined as an algorithm that produces a $(1 - \varepsilon)$-optimal solution in time polynomial in $m$ and $1 / \varepsilon$. Familiar examples of problems that admit an FPTAS include the knapsack problem, the constrained spanning tree problem, a constrained parallel scheduling problem on two machines, and the replenishment storage problem (Vazirani 2001; Hong et al. 2004; Woeginger 2005; Hochbaum and Rao 2020). The existence of an FPTAS for an optimization problem is a desirable property because an FPTAS induces a continuum of polynomial-time algorithms with constant approximation guarantees.

A special case of \eqref{headlineproblem} arose in an equilibrium analysis of the United States college admissions market by Fu (2014). However, her econometric task involved clustering the schools such that $m=8$, a scale at which enumeration is tractable. We are interested in solution techniques that scale efficiently in the number of colleges.

To the best of our knowledge, the first systematic study of the college application problem was conducted by this article's first author in his master's thesis (Kapur 2022). The present article extends Kapur's key results with a more precise analysis of the problem's computational complexity and a new solution algorithm.

\subsection{Outline}

This paper has five sections. In section \ref{sectionPrelims}, we establish some notation and introduce assumptions that can be imposed with little loss of generality. In section \ref{sectionNPC}, we prove that the college application problem is NP-complete. Section \ref{sectionAlgos} presents three optimization algorithms, including the FPTAS. A brief conclusion follows.

\section{Preliminaries} \label{sectionPrelims}

For the remainder of the paper, we assume with minimal loss of generality that $f_j \in \mathbb{Q}$, $t_j \in \mathbb{N}$, $g_j \in \mathbb{N}$, and $H \in \mathbb{N}$; that the $f_j$-values have the same denominator $D$; and that $t_0 < t_1 \leq \dots \leq t_m$, $g_j \leq H$, and $\sum g_j > H$. Unless otherwise noted, we assume that $t_0 = 0$, an assumption we justify below.

\subsection{The objective function} \label{sectionObjective}

This subsection derives a closed-form expression for the objective function of \eqref{headlineproblem}.

We refer to the set $\mathcal{X} \subseteq \mathcal{C}$ of schools to which a student applies as her \emph{application portfolio.} The expected utility the student receives from $\mathcal{X}$ is called its \emph{valuation}. Given an application portfolio, let $p_j(\mathcal{X})$ denote the probability that the student attends school $j$. This occurs if and only if she \emph{applies} to school $j$, is \emph{admitted} to school $j$, and is \emph{rejected} from any school she prefers to $j$; that is, any school with higher index. Hence, for $j= 0\dots m$,
\begin{align}
p_j(\mathcal{X}) &= 
\begin{cases}
\displaystyle f_j  \prod_{\substack{i \in \mathcal{X}: \\ i > j}} (1 - f_{i}), \quad & j \in \{0\}\cup\mathcal{X}\\
0, \quad & \text{otherwise}
\end{cases} 
\end{align}
The following proposition follows by computing $v(\mathcal{X}) = \sum_{j=0}^m  t_j p_j(\mathcal{X})$.
\begin{proposition}[Closed form of portfolio valuation function]
\begin{align}
v(\mathcal{X}) &= \sum_{j=0}^m t_j p_j(\mathcal{X}) = \sum_{j\in\{0\}\cup\mathcal{X}} \Bigl( f_j t_j \prod_{\substack{i \in \mathcal{X}: \\ i > j}} (1 - f_{i}) \Bigr)  \label{closedformportfoliovaluationX}%, \quad \text{or equivalently,}\\
%\qquad v(x) &= t_0 \prod_{j=1}^m (1 - f_{j} x_j) + \sum_{j=1}^m \Bigl( x_j t_j f_j \prod_{j’ = j+1}^m (1 - f_{j’} x_{j’}) \Bigr) \label{closedformportfoliovaluationx}
\end{align}
\end{proposition}
%\begin{proof}Computing $v(\mathcal{X}) = \sum_{j=0}^m  t_j p_j(\mathcal{X})$ yields \eqref{closedformportfoliovaluationX}. Next, because $1 - f_j x_j = 1$ if $x_j = 0$, we may define $p_j$ equivalently as $p_j(x) = x_j  f_j \prod_{j’ = j+1}^m (1 - f_{j’} x_{j’})$ to obtain \eqref{closedformportfoliovaluationx}. 
%\end{proof}

Next, we show that without loss of generality, we may assume that $t_0 = 0$.

\begin{lemma} \label{assumetzerozero}
For some $\gamma \leq t_0$, let $\bar t_j = t_j - \gamma$ for $j = 0 \dots m$. Then $v(\mathcal{X}; \bar t_j) = v(\mathcal{X};  t_j) -  \gamma$ regardless of $\mathcal{X}$. 
\end{lemma}
\begin{proof}
By definition, $\sum_{j=0}^m p_j(\mathcal{X}) = \sum_{j \in \{0\}\cup\mathcal{X}} p_j(\mathcal{X}) = 1$. Therefore
\begin{align}
\begin{split}
v(\mathcal{X}; \bar t_j) &= \sum_{j\in \{0\}\cup\mathcal{X}}  \bar t_j p_j(\mathcal{X})
=\sum_{j\in \{0\}\cup\mathcal{X}} (t_j - \gamma) p_j(\mathcal{X}) \\
&=\sum_{j\in \{0\}\cup\mathcal{X}} t_j p_j(\mathcal{X})  - \gamma 
= v(\mathcal{X}; t_j) - \gamma
\end{split} 
\end{align}
which completes the proof.
\end{proof}


\subsection{Submodularity}

The following result is offered primarily for taxonomical interest and may be safely skipped: Our solution algorithms for the college application problem outperform generic algorithms for submodular maximization, and we prove their validity without appealing to submodular analysis.

\begin{definition}[Submodular set function]
Given a ground set $\mathcal{C}$ and function $v : 2^{\mathcal{C}} \mapsto \mathbb{R}$, $v(\mathcal{X})$ is called a \emph{submodular set function} if and only if $v(\mathcal{X}) + v(\mathcal{Y}) \geq v(\mathcal{X}\cup\mathcal{Y}) + v(\mathcal{X}\cap\mathcal{Y})$
for all $\mathcal{X}, \mathcal{Y} \subseteq \mathcal{C}$. Furthermore, if $ v(\mathcal{X}\cup\{k\}) - v(\mathcal{X}) \geq 0$ for all $\mathcal{X} \subset \mathcal{C}$ and $k \in \mathcal{C} \setminus \mathcal{X}$, $v(\mathcal{X})$ is said to be a \emph{nondecreasing} submodular set function.
\end{definition}

\begin{theorem}
The college application portfolio valuation function
$v(\mathcal{X})$ % = \sum_{j\in\mathcal{X}} \Bigl( f_j t_j \prod_{\substack{i \in \mathcal{X}: \\ i > j}} (1 - f_{i}) \Bigr)\]
is a nondecreasing submodular set function.
\end{theorem}


\begin{proof}
See Kapur (2022, \S\,2.3). 
\end{proof}








\section{NP-completeness} \label{sectionNPC}

In this section, we will show that the college application problem is NP-complete by transformation from the binary knapsack problem, which is known to be NP-complete (Garey and Johnson 1979, \S\,3.2.1). We begin by presenting the knapsack and college applications as decision problems. 


\begin{definition}[Decision form of knapsack problem (KP)]
\textbf{Instance:} a set $\mathcal{B}$ of $m$ objects, utility values $u_j \in \mathbb{N}$ and weight $w_j \in \mathbb{N}$ for each $j \in \mathcal{B}$, knapsack capacity $W\in \mathbb{N}$, and target utility $U\in \mathbb{N}$. \textbf{Question:} Is there a set $\mathcal{B’} \subseteq \mathcal{B}$ having $\sum_{j \in \mathcal{B’}} u_j \geq U$ and  $\sum_{j \in \mathcal{B’}} w_j \leq W$?
\end{definition}

\begin{theorem}
KP is NP-complete. 
\end{theorem}

\begin{proof}See Garey and Johnson (1979, \S\,3.2.1).\end{proof}

\begin{definition}[Decision form of the college application problem (CAP)] \label{ellisdecisionform}
\textbf{Instance:} an instance $(f, t, g, H)$ of the college application problem and a target valuation $V$. \textbf{Question:} Is there a a portfolio $\mathcal{X} \subseteq \mathcal{C}$ having $v(\mathcal{X}) \geq V$ and  $\sum_{j \in \mathcal{X}} g_j \leq H$?
\end{definition}

\begin{theorem}
CAP is NP-complete.
\end{theorem}

\begin{proof}
(CAP $\in$ NP.) It suffices to show that the cost and value of a given $\mathcal{X} \subseteq \mathcal{C}$ can be computed in polynomial time. Given an oracle that multiplies integers in unit time, $v(\mathcal{X})$ can be computed in polynomial time using the following algorithm (which assumes that the elements of $\mathcal{X}$ are iterated in index order):

\RestyleAlgo{plain}
\LinesNotNumbered 
\begin{algorithm}[h]
\SetAlgoCaptionSeparator{}% no separator, default colon
\SetAlCapNameSty{}% no caption text
$v \gets 0$\;
\For{$j \in \mathcal{X}$}{
	$v \gets (1 - f_j)\,v + f_j t_j$\;
}
\Return{$v$}\;
\end{algorithm}

\noindent However, because the denominator of $v(\mathcal{X})$ grows rapidly as schools are added to $\mathcal{X}$, we need to show that the number of bits of information required to store $v(\mathcal{X})$ is polynomial in the size of the input data. Let $K = \max\bigl\{\max t_j, \max g_j, D\bigr\}$ denote the largest integer in the input data. Then the instance data can be written in $O(K m)$-space, and $v(\mathcal{X})$ is a rational number whose numerator is at most $m \times K \times K^m = m K^{m+1}$, and whose denominator is at most $K^m$. Therefore, a verifier for $\mathcal{X}$ needs
\[O\bigl(\log (m K^{m+1}) \bigr) \subset O\bigl( m \log Km )\]
bits of information to store $v(\mathcal{X})$, as required.

(KP $\propto$ CAP.) Consider an instance of the knapsack problem, and we will construct an instance of Problem \ref{ellisdecisionform} that is a yes-instance if and only if the corresponding knapsack instance is a yes-instance. Without loss of generality, we may assume that the objects in $\mathcal{B}$ are indexed in increasing order of $u_j$, that each $u_j >0$, and that each $w_j \leq W$. 

Let $U_{\mathrm{max}} = \sum_{j \in \mathcal{B}} u_j$ and $\delta = {1} /{m U_{\mathrm{max}}} > 0$, and construct an instance of CAP with $\mathcal{C} = \mathcal{B}$, $H = W$, all $f_j = \delta$, and each $t_j = u_j / \delta$. Clearly, $\mathcal{X} \subseteq \mathcal{C}$ is feasible for CAP if and only if it is feasible for the knapsack instance. Now, we observe that for any nonempty $\mathcal{X}$,
\begin{align}
\begin{split}
\sum_{j \in \mathcal{X}} u_j &=  \sum_{j \in \mathcal{X}} f_j t_j
> \sum_{j \in \mathcal{X}} \Bigl( f_j t_j \prod_{\substack{j’ \in \mathcal{X}: \\ j' > j}} (1 - f_{j’}) \Bigr)
= v(\mathcal{X}) \\
&= \sum_{j \in \mathcal{X}} \Bigl( u_j  \prod_{\substack{j’ \in \mathcal{X}: \\ j' > j}} (1 - \delta) \Bigr)
\geq (1 - \delta)^m \sum_{j \in \mathcal{X}} u_j \\
&\geq (1 - m\delta) \sum_{j \in \mathcal{X}} u_j 
\geq \sum_{j \in \mathcal{X}} u_j  - m\delta U_{\mathrm{max}}
= \sum_{j \in \mathcal{X}} u_j  - 1.
\end{split}
\end{align}
This means that the utility of an application portfolio $\mathcal{X}$ in the corresponding knapsack instance is the smallest integer greater than $v( \mathcal{X})$. That is, $\sum_{j \in \mathcal{X}} u_j \geq U$ if and only if $v(\mathcal{X}) \geq U -1$. Taking $V = U-1$ completes the transformation and concludes the proof. 
\end{proof}






\section{Optimization algorithms} \label{sectionAlgos}

In this section, we present three optimization algorithms for the college application problem. The first two are exact dynamic programming (DP) algorithms. The third algorithm is a fully polynomial-time approximation scheme (FPTAS) based on the second DP.


 % We will use this algorithm as the basis for an FPTAS for the college application problem that uses $O(m^3 / \varepsilon)$ time and space.

\subsection{Dynamic program based on application expenditures}
The first DP produces an optimal solution to the college application problem in $O(Hm + m\log m)$ time. It resembles a familiar DP algorithm for the binary knapsack problem (Dantzig 1957).

For $j = 0 \dots m$ and $h = 0 \dots H$, let $\mathcal{X}(j, h)$ denote the optimal portfolio that uses only the schools $\{ 1, \dots, j\}$ and costs no more than $h$, and let $V(j,h) = v\bigl(\mathcal{X}(j, h)\bigr)$. Clearly, if $j=0$ or $h=0$, then $\mathcal{X}(j, h) = \O$ and $V(j, h) = 0$. It is also convenient to let $V(j, h) = -\infty$ for all $h < 0$.

For the remaining indices, $\mathcal{X}(j, h)$ either contains $j$ or not. If it does not contain $j$, then $\mathcal{X}(j, h) = \mathcal{X}(j-1, h)$. On the other hand, if  $\mathcal{X}(j, h)$ contains $j$, then its valuation is $(1 - f_j) v(\mathcal{X}[j, h]\setminus \{j\}) + f_j t_j$. Therefore, $\mathcal{X}(j, h)\setminus \{j\}$ must make optimal use of the remaining budget over the remaining schools; that is, $\mathcal{X}(j, h) = \mathcal{X}(j-1, h - g_j) \cup\{j\}$. From these observations, we obtain the following recursion for $ j = 1\dots m$ and $h = 1\dots H$:
\begin{align}
V(j, h) = \max\bigl\{ V(j-1, h), (1 - f_j) V(j-1, h-g_j) + f_j t_j \bigr\}
\end{align}
with the convention that $ -\infty \cdot 0 = -\infty$. Given the values of $V(j, h)$ at each index, the corresponding optimal portfolios are computed by observing that $\mathcal{X}(j, h)$ contains $j$ if and only if $V(j, h) > V(j-1, h)$. The optimal solution is given by $\mathcal{X}(m, H)$. The algorithm below performs these computations and outputs the optimal portfolio $\mathcal{X}$. 

\begin{algorithm}[h] 
%\DontPrintSemicolon
\caption{Application expenditures DP for \eqref{headlineproblem}.} \label{ellisDP1}
\KwIn{$f \in \mathbb{Q}^m$, $t \in \mathbb{N}^m$, $g \in \mathbb{N}^m$, $H \in\mathbb{N}$.}
Sort schools by $t_j$ ascending\;
Fill a lookup table with the values of $V(j, h)$\; \label{Vcreatedlookuptable}
$h \gets H$\;
$\mathcal{X} \gets \O$\;
\For{$j = m, m-1, \dots, 1$}{
	\If{$V[j-1, h] < V[j, h]$}{
		$\mathcal{X} \gets \mathcal{X}\cup\{j\}$\; 
		$h \gets h - g_j$\;
	}
}
\Return{$\mathcal{X}$}\;
\end{algorithm}

\begin{theorem}[Validity of Algorithm \ref{ellisDP1}]
Algorithm \ref{ellisDP1} produces an optimal application portfolio for the college application problem in $O(H m + m \log m)$ time.
\end{theorem}

\begin{proof}
Optimality follows from the foregoing discussion. Sorting $t$ is $O(m \log m)$. The bottleneck step is the creation of the lookup table for $V(j, h)$ in line \ref{Vcreatedlookuptable}. Each entry is generated in unit time, and the size of the table is $O(Hm)$.
\end{proof}

Because we cannot assume that $H \leq m$, Algorithm \ref{ellisDP1} represents a pseudopolynomial-time solution (Garey and Johnson 1979, \S\,4.2). However, it is quite effective for typical instances in which the application costs are small integers. It is also a polynomial-time algorithm for the special case of the college application problem in which each $g_j = 1$, meaning that $H$ is a limit on the \emph{cardinality} $\mathcal{X}$, and $H < \sum g_j = m$ in any nontrivial instance. 

\subsection{Dynamic program based on portfolio valuations} \label{dpbasedonportfoliovaluations}

As with the knapsack problem, the college application problem admits a complementary DP that iterates on the value of the cheapest portfolio instead of on the cost of the most valuable portfolio.

Let $\mathbb{Z}/D$ denote the set of integer multiples of $1/D$. For integers $0 \leq j \leq m$ and $v \in \mathbb{Z}/{D^m}$, let $\mathcal{W}(j, v)$ denote the least expensive portfolio that uses only schools $\{ 1, \dots, j\}$ and has valuation at least $v$, if such a portfolio exists. Denote its cost by $G(j, v) = \sum_{j\in \mathcal{W}(j, v)} g_j$, where $G(j, v) = \infty$ if $\mathcal{W}(j, v)$ does not exist. Clearly, if $v \leq 0$, then $\mathcal{W}(j, v) = \O$ and $G(j, h) = 0$, and if $j = 0$ and $v > 0$, then $(j, h) = \infty$.  For the remaining indices (where $j, v > 0$), we claim that
\begin{align} \label{recursionrelationforcostmindp}
G(j, v) &=
\begin{cases}
\infty, \quad & t_j < v \\
\min\Bigl\{G(j-1, v), g_j + G\bigl(j-1, v - \Delta_j(v)\bigr) \Bigr\}, \quad & t_j \geq v 
%\begin{cases}
%\min\bigl\{G[j-1, v], g_j + G[j-1, v - \Delta] \bigr\}, \quad &f_j < 1 \\
%\min\bigl\{G[j-1, v], g_j \bigr\}, \quad &f_j = 1 \text{ and } f_j t_j \geq v\\
%G[j-1, v], \quad &f_j = 1 \text{ and } f_j t_j < v
\end{cases}\\
\text{where}\qquad
\Delta_j (v) &= 
\begin{cases}
\frac{f_j}{1 - f_j} (t_j - v), \quad & f_j < 1\\
\infty, &f_j = 1.
\end{cases} \label{deltajvdef}
\end{align}
In the $t_j < v$ case, any feasible portfolio must be composed of schools with utility less than $v$, and therefore its valuation can not equal $v$, meaning that $\mathcal{W}(j, v)$ is undefined. In the $t_j \geq v$ case, the first argument to $\min\{\}$ says simply that omitting $j$ and choosing $\mathcal{W}(j-1, v)$ is a permissible choice for $\mathcal{W}(j, v)$. If, on the other hand, $j \in \mathcal{W}(j, v)$, then
\begin{equation} \label{solvemeforvwjvminusj}
v(\mathcal{W}[j, v]) = (1 - f_j )\,v(\mathcal{W}[j, v]\setminus \{j\}) + f_j t_j.
\end{equation}
Therefore, the subportfolio $\mathcal{W}(j, v)\setminus \{j\}$ must have a valuation of $v - \Delta$, where $\Delta$ satisfies $v = (1 - f_j )(v - \Delta) + f_j t_j $. When $f_j < 1$, the solution to this equation is $ \Delta = \frac{f_j}{1 - f_j} (t_j - v)$. When $t_j \geq v$ and $f_j = 1$, the singleton $\{j\}$ has $v(\{j\}) \geq v$, so
\begin{equation}G[j, v] = \min\bigl\{G[j-1, v], g_j \bigr\}.\end{equation}
Defining $\Delta_j(v) = \infty$ in this case ensures that $g_j + G[j-1, v-\Delta_j(v)] = g_j+ G[j-1, v-\infty] = g_j $ as required.

To compute the optimal portfolio, we first note that its valuation cannot exceed $v(\mathcal{C})$. Therefore, under our assumptions, the optimal portfolio valuation is an element of the finite set
\begin{equation}
\mathcal{V} = \Bigl\{0, 1/D^m, 2/D^m, \cdots, v(\mathcal{C}) - 1/ D^m, v(\mathcal{C})\Bigr\}.
\end{equation}
Therefore, if we recursively compute the values of $G(j, v)$ for each $j\in \mathcal{C}$ and $v \in \mathcal{V}$, the optimal portfolio valuation is simply the largest achievable objective value $\max\{ w: G(m, w) \leq H\}$ and $\max\{ w: G[m, w] \leq H\}$. The corresponding portfolio can be computed  portfolio associated with $G(j, v)$ can be computed by applying the observation that $\mathcal{W}(j, v)$ contains $j$ if and only if $G(j, v) < G(j-1, v)$.

\begin{algorithm}[h] 
%\DontPrintSemicolon
\caption{Portfolio valuations DP for \eqref{headlineproblem}.} \label{ellisDP2}
\KwIn{$f \in \mathbb{Q}^m$, $t \in \mathbb{N}^m$, $g \in \mathbb{N}^m$, $H \in\mathbb{N}$.}
Sort schools by $t_j$ ascending\;
Fill a lookup table with the entries of $G(j, h)$\; \label{createdlookuptable}
$v\gets  \max\{ w \in \mathcal{V} : G(m, w) \leq H\}$\; \label{vrecordedhere}
$\mathcal{X} \gets \O$\;
\For{$j = m, m-1, \dots, 1$}{
	\If{$G(j, v) < \infty$ and $G(j, v) < G(j-1, v)$}{
		$\mathcal{X} \gets \mathcal{X}\cup\{j\}$\; 
		$v \gets v -  \Delta_j(v)$\;
	}
}
\Return{$\mathcal{X}$}\;
\end{algorithm}

\begin{theorem}[Validity of Algorithm \ref{ellisDP2}]
Algorithm \ref{ellisDP2} produces an optimal solution to the college application problem in $O\bigl( D^m v(\mathcal{C}) m^2 \bigr)$ time.
\end{theorem}

\begin{proof}
Optimality is as discussed above. The computation time is proportional to the size of the table created in line \ref{createdlookuptable}, which is $m \times |\mathcal{V}| = m \times D^m \times v(\mathcal{C}) $. 
\end{proof}

\subsection{Fully polynomial-time approximation scheme}
On its surface, the computation time of Algorithm \ref{ellisDP2} is formidable, but a small modification yields an FPTAS for the college application problem that computes a $(1 - \varepsilon)$-optimal solution in $O(m^3 / \varepsilon)$ time.

To construct the FPTAS, we approximate each portfolio's valuation using a fixed-point binary number with a precision of $P$, where $P$ is the number of digits to retain after the radix point. Let $r[x] =  2^{-P}\lfloor 2^P x \rfloor$ denote the value of $x$ rounded down to its nearest fixed-point representation. To allow for approximation error, we need to use the looser upper bound $\bar U = \sum_{j\in \mathcal{C}} f_j t_j > v(\mathcal{C})$ on the optimal portfolio valuation. Since we will ensure that each fixed-point approximation is an \emph{underestimate} of the portfolio's true valuation, the set $\mathcal{V}'$ of valuations observable in the fixed-point framework remains finite:
\begin{equation}
\mathcal{V}' = \Bigl\{0, 1\times 2^{-P}, 2\times 2^{-P}, \dots, r\bigl[\bar U- 1\times 2^{-P}\bigr], r\bigl[\bar U\bigr]\Bigr\}.
\end{equation}

%For the remainder of this subsection, unless otherwise specified, the word \emph{valuation} refers to a portfolio’s valuation within the fixed-point framework, with the understanding that this is an approximation. We will use square brackets to emphasize potential sources of approximation error, and account for this error below when we prove the FPTAS's validity.

The details of the FPTAS are similar to those of Algorithm \ref{ellisDP2}. For integers $0 \leq j \leq m$ and $v \in \mathbb{Z}/2^P \cap \mathcal{V}'$, $\mathcal{W}[j, v]$ denotes the least expensive portfolio that uses only schools $\{ 1, \dots, j\}$ and has valuation of \emph{at least} $v$, if such a portfolio exists. Its cost is given by $G[j, v] = \sum_{j\in \mathcal{W}[j, v]} g_j$. The boundary conditions and recursion relation are identical to those given above (subsection \ref{dpbasedonportfoliovaluations}), except that $\Delta_j(v)$ is replaced with
\begin{align}
\Delta_j[v]
\begin{cases}
r\left[\frac{f_j}{1 - f_j} (t_j - v)\right], \quad & f_j < 1\\
\infty, &f_j = 1.
\end{cases} \label{clampeddeltajvdef}
\end{align}
Here we have rounded the solution of \eqref{solvemeforvwjvminusj} down to ensure that the true valuation of $\mathcal{W}[j, v]$ is \emph{at least} $v - \Delta$, and therefore that $G[j, v]$ meets its definition.

Intuitively, $\max\{ w \in \mathcal{V}': G[m, w] \leq H\}$ gives the optimal portfolio valuation up to a certain amount of approximation error dependent on $P$. In Algorithm \ref{ellisDP3} and Theorem \ref{validityoffptas}, we formalize this intuition by showing that $P \geq \log_{2}\left(m^2 / \varepsilon \bar U\right)$ ensures an optimality ratio of $1 - \varepsilon$ or better.

\begin{algorithm}[h] 
%\DontPrintSemicolon
\caption{FPTAS for \eqref{headlineproblem}.} \label{ellisDP3}
\KwIn{$f \in \mathbb{Q}^m$, $t \in \mathbb{N}^m$, $g \in \mathbb{N}^m$, $H \in\mathbb{N}$.}
\KwParams{Tolerance $\varepsilon \in (0, 1)$.}
Sort schools by $t_j$ ascending\;
Set precision $P \gets \bigl\lceil\log_{2}\left(m^2 / \varepsilon \bar U\right)\bigr\rceil$\;
Fill a lookup table with the entries of $G[j, h]$\; \label{createdlookuptable}
$v\gets  \max\{ w \in \mathcal{V} : G[m, w] \leq H\}$\; \label{vrecordedhere}
$\mathcal{X} \gets \O$\;
\For{$j = m, m-1, \dots, 1$}{
	\If{$G[j, v]< \infty$ and $G[j, v] < G[j-1, v]$}{
		$\mathcal{X} \gets \mathcal{X}\cup\{j\}$\; 
		$v \gets v -  \Delta_j[v]$\;
	}
}
\Return{$\mathcal{X}$}\;
\end{algorithm}

\begin{theorem}[Validity of Algorithm \ref{ellisDP3}] \label{validityoffptas}
Algorithm \ref{ellisDP3} produces a $(1 - \varepsilon)$-optimal application portfolio for the college application problem in $O(m^3 /\varepsilon)$ time. % and $O(m^3/\varepsilon)$ space.
\end{theorem}

\begin{proof}
(Optimality.) Let $\mathcal{W}$ denote the output of Algorithm \ref{ellisDP3} and $\mathcal{X}$ the true optimum. We know that $v(\mathcal{X}) \leq \bar U$, and because each singleton portfolio is feasible, $\mathcal{X}$ must be more valuable than the average singleton portfolio; that is, $v(\mathcal{X}) \geq \sum f_j t_j / m = \bar U / m$.

Because $\Delta_j(v)$ is rounded down according to \eqref{clampeddeltajvdef}, if $j \in \mathcal{W}[j, v]$, then the true value of $(1 - f_j) v\bigl(\mathcal{W}[j-1, v- \Delta_j(v)]\bigr) + f_j t_j$ may exceed the fixed-point valuation $v$ of $\mathcal{W}[j, v]$, but not by more than $2^{-P}$. This error accumulates additively with each school added to $\mathcal{W}$, but the number of additions is at most $m$. Therefore, where $v'(\mathcal{W})$ denotes the fixed-point valuation of $\mathcal{W}$ recorded in line \ref{vrecordedhere} of the algorithm, 
$v(\mathcal{W}) - v'(\mathcal{W}) \leq m 2^{-P}$.

We can define $v'(\mathcal{X})$ analogously as the fixed-point valuation of $\mathcal{X}$ when its elements are added in index order and its valuation is updated and rounded down to the nearest multiple of $2^{-P}$ at each addition in accordance with \eqref{solvemeforvwjvminusj}. By the same logic, 
$v(\mathcal{X}) - v'(\mathcal{X}) \leq m 2^{-P}$. The optimality of $\mathcal{W}$ in the fixed-point environment implies that $v'(\mathcal{W}) \geq v'(\mathcal{X})$. 

Applying these observations, we have
\begin{equation}
\begin{split}
v(\mathcal{W}) &\geq v'(\mathcal{W}) \geq v'(\mathcal{X})
\geq v(\mathcal{X}) - m 2^{-P}
%\\&
\geq \left(1 - \frac{m^2 2^{-P}}{\bar U}\right) v(\mathcal{X})
\geq \left(1 - \varepsilon\right) v(\mathcal{X})
\end{split}
\end{equation}
which establishes the approximation bound. 

(Computation time.) The bottleneck step is the creation of the lookup table in line \ref{createdlookuptable}, whose size is $m \times |\mathcal{V}'|$. Since
\begin{equation}
|\mathcal{V}| = \bar U \times 2^{P} + 1 = \bar U \times 2^ { \bigl\lceil\log_{2}\left(m ^2/ \varepsilon \bar U\right)\bigr\rceil} + 1
\leq\frac{m^2}{\varepsilon} \times \text{const.}
\end{equation}
is $O(m^2/ \varepsilon)$, the time complexity is as promised.
\end{proof}

Since its time complexity is polynomial in $m$ and $1 / \varepsilon$, Algorithm \ref{ellisDP3} is an FPTAS for the college application problem (Vazirani 2001). 

Algorithms \ref{ellisDP1}, \ref{ellisDP2}, and \ref{ellisDP3} can be written using recursive functions instead of lookup tables. However, since each function references itself \emph{twice,} the function values at each index must be recorded in the computer's memory to take advantage of overlapping indices and guarantee the runtimes promised above. A discussion of these and other implementation appears in Kapur (2022), along with a computational study demonstrating the efficiency of Algorithms \ref{ellisDP1} and \ref{ellisDP3}.









\section{Conclusion} \label{sectionConclusion}

This article has introduced a novel nonlinear knapsack problem called the college application problem. Our results suggest that the college application is a relatively easy instance of submodular maximization: The FPTAS presented here induces a continuum of tight, polynomial-time approximation algorithms, whereas no polynomial-time algorithm for the general problem of maximizing a nondecreasing submodular function over a knapsack constraint provides an approximation guarantee better than $1 - 1/e$.

One interpretation of our result is that the objective function of the college application, though nonlinear, has similar regularity properties to a linear function. Further evidence for this view is found in Kapur (2022)'s analysis of the college application problem with a cardinality constraint, which can be solved by a simple greedy algorithm. We conjecture that other results associated with maximizing linear functions may hold with respect to the objective discussed here, such the existence of a PTAS when maximizing over the intersection of knapsack constraints, and the optimality of the greedy algorithm when maximizing over a polymatroidal system (Chekuri and Khanna 2005; Edmonds 1971).

\section{References}
\noindent 

\parskip 0em
\leftskip 2em
\parindent -2em
%Acharya, Mohan S., Asfia Armaan, and Aneeta S. Antony. 2019. ``A Comparison of Regression Models for Prediction of Graduate Admissions.'' In \emph{Second International Conference on Computational Intelligence in Data Science.} \url{https://doi.org/10.1109/ICCIDS.2019.8862140}.
%
%Ashlagi, Itai, and Afshin Nikzad. 2020. ``What Matters in School Choice Tie-Breaking? How Competition Guides Design.'' \emph{Journal of Economic Theory} 190: article no. 105120. \url{https://doi.org/10.1016/j.jet.2020.105120}.
%
%Assad, Arjang. 1985. ``Nested Optimal Policies for Set Functions with Applications to Scheduling.'' \emph{Mathematics of Operations Research} 10 (1): 82--99.
%
%Azevedo, Eduardo and Jacob Leshno. 2016. ``A Supply and Demand Framework for Two-Sided Matching Markets.'' \emph{Journal of Political Economy} 124 (5): 1235--68. \url{https://doi.org/10.1086/687476}. 
%
Badanidiyuru, Ashwinkumar and Jan Vondrák. 2014. ``Fast Algorithms for Maximizing Submodular Functions.'' In \emph{Proceedings of the 2014 Annual ACM--SIAM Symposium on Discrete Algorithms}, 1497--1514. \url{https://doi.org/10.1137/1.9781611973402.110}.

%Balas, Egon and Eitan Zemel. 1980. ``An Algorithm for Large Zero-One Knapsack Problems.'' \emph{Operations Research} 28 (5): 1130--54. \url{https://doi.org/10.1287/opre.28.5.1130}. 
%
%Bezanson, Jeff, Alan Edelman, Stefan Karpinski, and Viral B. Shah. 2017. ``Julia: A Fresh Approach to Numerical Computing.'' \emph{SIAM Review} 59: 65–98. \url{https://doi.org/10.1137/141000671}.
%
%Blum,  Manuel, Robert W. Floyd, Vaughan Pratt, Ronald L. Rivest, and Robert E. Tarjan. 1973. ``Time Bounds for Selection.'' \emph{Journal of Computer and System Sciences} 7 (4): 448--61. \url{https://doi.org/10.1016/S0022-0000(73)80033-9}.
%
%Bodoh-Creed, Aaron. 2020. ``Optimizing for Distributional Goals in School Choice Problems.'' \emph{Management Science} 66 (8): 3657--76. \url{https://doi.org/10.1287/mnsc.2019.3376}.
%
%%Budish, Eric. 2011. ``The Combinatorial Assignment Problem: Approximate Competitive Equilibrium from Equal Incomes.'' \emph{Journal of Political Economy} 119 (6): 1061--1103. \url{https://doi.org/10.1086/664613}. 
%
%% 1 - 1/e opt for the problem in the title
%Calinescu, Gruia, Chandra Chekuri, Martin Pál, and Jan Vondrák. 2011. ``Maximizing a Monotone Submodular Function Subject to a Matroid Constraint.'' \emph{SIAM Journal on Computing} 40 (6): 1740--66. \url{https://doi.org/10.1137/080733991}.
%
%Carraway, Robert, Robert Schmidt, and Lawrence Weatherford. 1993. ``An Algorithm for Maximizing Target Achievement in the Stochastic Knapsack Problem with Normal Returns.'' \emph{Naval Research Logistics} 40 (2): 161--73. \url{https://doi.org/10.1002/nav.3220400203}.
%
Chekuri, Chandra, Jan Vondr\'ak, and Rico Zenklusen. 2014. ``Submodular Function Maximization via the Multilinear Relaxation and Contention Resolution Schemes.'' \emph{SIAM Journal on Computing} 43 (6): 1831--79. \url{https://doi.org/10.1137/110839655}.

Chekuri, Chandra and Sanjeev Khanna. 2005. ``A Polynomial Time Approximation Scheme for the Multiple Knapsack Problem.'' \emph{SIAM Journal on Computing} 35 (3): 713--28. \url{https://doi.org/10.1137/S0097539700382820}.

%Cormen, Thomas, Charles Leiserson, and Ronald Rivest. 1990. \emph{Introduction to Algorithms.} Cambridge, MA: The MIT Press.
%
%Dantzig, George B. 1957. ``Discrete-Variable Extremum Problems.'' \emph{Operations Research} 5 (2): 266--88.
%
%Dean, Brian, Michel Goemans, and Jan Vondr\'ak. 2008. ``Approximating the Stochastic Knapsack Problem: The Benefit of Adaptivity.'' \emph{Mathematics of Operations Research} 33 (4): 945--64. \url{https://doi.org/10.1287/moor.1080.0330}.
%
Edmonds, Jack. 1971. ``Matroids and the Greedy Algorithm.'' \emph{Mathematical Programming} 1: 127--36. \url{https://doi.org/10.1007/BF01584082}.  
%
%
%%Fredman, Michael Lawrence and Robert Tarjan. 1987. ``Fibonacci Heaps and Their Uses in Improved Network Optimization Algorithms.'' \emph{Journal of the Association for Computing Machinery} 34 (3): 596--615.
%
Fu, Chao. 2014. ``Equilibrium Tuition, Applications, Admissions, and Enrollment in the College Market.'' \emph{Journal of Political Economy} 122 (2): 225--81. \url{https://doi.org/10.1086/675503}. 

%Gale, David, and Lloyd Shapley. 1962. ``College Admissions and the Stability of Marriage.'' \emph{American Mathematics Monthly} 69 (1): 9--15. \url{https://doi.org/10.2307/2312726}.
%
%Garey, Michael and David Johnson. 1979. \emph{Computers and Intractability: A Guide to the Theory of NP-Completeness.} New York: W. H. Freeman and Company. 
%
%Hartlaub, Vanessa and Thorsten Schneider. 2012. “Educational Choice and Risk Aversion: How Important Is Structural vs. Individual Risk Aversion?” \emph{SOEPpapers on Multidisciplinary Panel Data Research,} no. 433. \url{https://www.diw.de/documents/publikationen/73/diw_01.c.394455.de/diw_sp0433.pdf}.
%
Hong, Sung-Pil, Sung-Jin Chung, and Bum Hwan Park. 2004. ``A Fully Polynomial Bicriteria Approximation Scheme for the Constrained Spanning Tree Problem.'' \emph{Operations Research Letters} 32 (3): 233--39. \url{https://doi.org/10.1016/j.orl.2003.06.003}.

%Jeon, Minhee. 2015. ``[College application strategy] Six chances total\dots divide applications across reach, target, and safety schools'' (in Korean). Jungang Ilbo, Aug. 26. \url{https://www.joongang.co.kr/article/18524069}.
%
%Kahneman, Daniel. 2011. \emph{Thinking, Fast and Slow.} New York: Macmillan.
%
%Kapur, Max. 2021. ``Characterizing Nonatomic Admissions Markets.'' ArXiv, July 3, 2021. \url{https://arxiv.org/abs/2107.01340}. 
%
Kapur, Max. 2022. ``The College Application Problem.'' Master's thesis, Seoul National University. 

%Kellerer, Hans, Ulrich Pferschy, and David Pisinger. 2004. \emph{Knapsack Problems.} Berlin: Springer.
%
%%1 - 1/ e for monotonic submodular with knapsack constraints, i.e. Ellis with 가나다
Kulik, Ariel, Hadas Shachnai, and Tami Tamir. 2013. ``Approximations for Monotone and Nonmonotone Submodular Maximization with Knapsack Constraints.'' \emph{Mathematics of Operations Research} 38 (4): 729--39. \url{https://doi.org/10.1287/moor.2013.0592}.

%Lim, Daniel Kibum. 2013. ``A Simulation Approach to Predicting College Admissions.'' Master's thesis, University of California Los Angeles. \url{https://escholarship.org/uc/item/8r2695n5}.
%
%Markowitz, Harry. 1952. ``Portfolio Selection.'' \emph{The Journal of Finance} 7 (1): 77--91. \url{https://www.jstor.org/stable/2975974}.
%
%Martello, Silvano and Paolo Toth. 1990. \emph{Knapsack Problems: Algorithms and Computer Implementations.} New York: John Wiley \& Sons. 
%
%Meucci, Attilio. 2005. \emph{Risk and Asset Allocation.} Berlin: Springer-Verlag, 2005. 
%
%% 1 - 1/e inapproximability of submodular maximization
Nemhauser, George and Laurence Wolsey. 1978. ``Best Algorithms for Approximating the Maximum of a Submodular Set Function.'' \emph{Mathematics of Operations Research} 3 (3): 177--88. \url{https://doi.org/10.1287/moor.3.3.177}.

Nemhauser, George, Laurence Wolsey, and Marshall Fisher. 1978. ``An Analysis of Approximations for Maximizing Submodular Set Functions—I.'' \emph{Mathematical Programming} 14: 265--94. 

%%Othman, Abraham, Eric Budish, and Tuomas Sandholm. 2010. ``Finding Approximate Competitive Equilibria: Efficient and Fair Course Allocation.'' In \emph{Proceedings of 9th International Conference on Autonomous Agents and Multiagent Systems.} New York: ACM. \url{https://dl.acm.org/doi/abs/10.5555/1838206.1838323}.
%
%Parker, R. Gary and Ronald L. Rardin. 1988. \emph{Discrete Optimization.} San Diego: Academic Press.
%
%Roth, Alvin E. 1982. ``The Economics of Matching: Stability and Incentives.'' \emph{Mathematics of Operations Research} 7 (4): 617--28. \url{https://www.jstor.org/stable/3689483}.
%
%Rozanov, Mark and Arie Tamir. 2020. ``The Nestedness Property of the Convex Ordered Median Location Problem on a Tree.'' \emph{Discrete Optimization} 36: 100581. \url{https://doi.org/10.1016/j.disopt.2020.100581}.
%
%Sklarow, Mark. 2018. \emph{State of the Profession 2018: The 10 Trends Reshaping Independent Educational Consulting.} Technical report, Independent Educational Consultants Association. \url{https://www.iecaonline.com/wp-content/uploads/2020/02/IECA-Current-Trends-2018.pdf}.
%
%Sniedovich, Moshe. 1980. ``Preference Order Stochastic Knapsack Problems: Methodological Issues.'' \emph{The Journal of the Operational Research Society} 31 (11): 1025--32. \url{https://www.jstor.org/stable/2581283}. 
%
%Steinberg, E. and M. S. Parks. 1979. ``A Preference Order Dynamic Program for a Knapsack Problem with Stochastic Rewards.'' \emph{The Journal of the Operational Research Society} 30 (2): 141--47. \url{https://www.jstor.org/stable/3009295}. 
%
%% Another ex of nestedness.
%%Tibshirani, Robert. 1996. ``Regression Shrinkage and Selection via the Lasso.'' \emph{Journal of the Royal Statistical Society,. Series B (Methodological)} 58, no. 1: 267--88. \url{https://www.jstor.org/stable/2346178}.
%
%Van Huizen, Thomas and Rob Alessie. 2019. ``Risk Aversion and Job Mobility.’’ \emph{Journal of Economic Behavior \& Organization} 164: 91--106. \url{https://doi.org/10.1016/j.jebo.2019.01.021}.
%
%Vazirani, Vijay. 2001. \emph{Approximation Algorithms.} Berlin: Springer. 
%
Woeginger, Gerhard. 2005. ``A Comment on Scheduling Two Parallel Machines with Capacity Constraints.'' \emph{Discrete Optimization} 2 (3): 269--72. \url{https://doi.org/10.1016/j.disopt.2005.06.005}. 

%Wolsey, Laurence. 1998. \emph{Integer Programming.} New York: John Wiley \& Sons. 
%
Hochbaum, Dorit and Xu Rao. 2020. ``A Fully Polynomial Time Approximation Scheme for the Replenishment Storage Problem.'' \emph{Operations Research Letters} 48 (6): 835--39. \url{https://doi.org/10.1016/j.orl.2020.10.004}.


\end{document}


\pagebreak

\tableofcontents



\pagebreak
\ifen \section{Introduction}  \else \section{서론} \fi
\ifen This paper considers the following optimization problem:

...

The problem is also conformable to other competitive matching games such as job application. Here, the budget constraint may represent the time needed to complete each application, or a legal limit on the number of applications permitted.

Some economists have constructed equilibrium models of the college admissions process that feature the student's application decision as a prominent subproblem. Fu (2014), for example, modeled the United States admissions market as a sequential game played by colleges and students. Colleges announce tuition rates, students apply to college, colleges announce admissions decisions and financial aid offers, and lastly, students decide where to enroll. Equilibrium arises when no college can improve its expected utility by modifying its tuition or admissions policy, and no student can improve her expected utility by modifying her application strategy. The ultimate goal of Fu's model was a comparative statics analysis of various hypothetical reforms to the structure of the admissions market; hence, it was adequate to cluster colleges into $m=8$ broad categories. Therefore, though estimating Fu's model required solving a problem similar to \eqref{headlineproblem}, it was a small instance that could be solved by enumerating all possible portfolios.\footnote{Fu's model of student utility uses a cost function in the size of the application portfolio instead of a budget constraint. Since the optimal portfolio in her model must be utility-optimal over portfolios of the same size, solving her student application problem reduces to solving $m$ instances of \eqref{headlineproblem}.} Our study pursues a more general solution.

The literature on admissions markets also includes a vast body of research on the deferred acceptance algorithm, an algorithm for matching students to schools having finite capacities that generalizes the Gale--Shapley algorithm for stable marriage. The algorithm takes students' ordinal preferences over schools and schools' ordinal preferences over students as input, and produces an assignment that possesses a number of desirable properties: It is a stable matching, meaning that no student--school pair is incentivized to deviate from the assignment. And the preference-reporting mechanism is incentive compatible, meaning that no student can improve her outcome by lying about her preferences (Gale and Shapley 1962; Roth 1982). In design, deferred acceptance is a centralized assignment algorithm; however, stable assignment also be interpreted as the equilibrium of a decentralized admissions game in which agents have perfect information about one another's preferences (Azevedo and Leshno 2016).

The utility model implied by stable assignment differs from that of the present study in two key ways: First, under stable assignment, students' preferences are ordinal rather than cardinal.\footnote{It is possible to estimate cardinal utility values from stable matchings in certain special cases, such as when colleges' preferences are identical and students' preferences are determined by the multinomial logit choice model (Kapur 2021).} Second, stable assignment is deterministic: The typical student-proposing deferred acceptance algorithm always produces the unique, student-optimal stable assignment. There exist variants of the deferred acceptance algorithm that introduce randomization in order to break ties in schools' preference lists or optimize for distributional goals such as gender parity, but because the randomization occurs after students submit their preferences, it has no effect on the optimal application strategy, which remains to report one's preferences honestly (Ashlagi and Nikzad 2020; Bodoh-Creed 2020). In the admissions process considered in this study, students face a tougher strategic challenge.

\ifen \subsection{Methodological orientation} \else \subsection{방법론적 지향} \fi
\ifen
Our analysis of the college application problem straddles several methodological universes. Its stochastic nature recalls classical portfolio allocation models. However, the knapsack constraint renders the problem NP-complete, and necessitates combinatorial solution techniques. We observe that the objective function is also a submodular set function, though our approximation results suggest that college application is a relatively easy instance of submodular maximization. 

In her equilibrium analysis of the American college market, Fu (2014) described college application as a ``nontrivial portfolio problem'' (226). In computational finance, traditional portfolio allocation models weigh the sum of expected profit across all assets against a risk term, yielding a concave maximization problem with linear constraints (Markowitz 1952; Meucci 2005). But college applicants maximize the expected value of their \emph{best} asset: If a student is admitted to her $j$th choice, then she is indifferent as to whether she gets into her $(j+1)$th choice. As a result, student utility is \emph{convex} in the utility associated with individual applications. Risk management is implicit in the college application problem because, in a typical admissions market, college preferability correlates inversely with competitiveness. That is, students negotiate a tradeoff between attractive, selective “reach schools” and less preferable “safety schools” where admission is a safer bet (Jeon 2015). Finally, the combinatorial nature of the college application problem makes it difficult to solve using the gradient-based techniques associated with continuous portfolio optimization.

The integer formulation of the college application problem can be viewed as a kind of binary knapsack problem with a polynomial objective function of degree $m$. Our branch-and-bound and dynamic programming algorithms closely resemble existing algorithms for knapsack problems (Martello and Toth 1990, \S\,2.5--6). In fact, by manipulating the admissions probabilities, the objective function can be made to approximate a linear function of the characteristic vector to an arbitrary degree of accuracy, a fact that we exploit in our NP-completeness proof. Previous research has introduced various forms of stochasticity to the knapsack problem, including variants in which each item's utility takes a known probability distribution (Steinberg and Parks 1979; Carraway et al. 1993) and an online context in which the weight of each item is observed after insertion into the knapsack (Dean et al. 2008). Our problem superficially resembles the preference-order knapsack problem considered by Steinberg and Parks and Carraway et al., but these models lack the college application problem's singular ``maximax'' form. Additionally, unlike those models, we do not attempt to replace the real-valued objective function with a preference order over \emph{outcome distributions,} which introduces technical issues concerning competing notions of stochastic dominance (Sniedovich 1980). We take for granted the student's preferences over \emph{outcomes} (as encoded in the $t_j$-values), and focus instead on an efficient computational approach to the well-defined problem above.


\ifen
We take special interest in the validity of greedy optimization algorithms, such as the algorithm that iteratively adds the school that elicits the greatest increase in the objective function until the budget is exhausted. Greedy algorithms produce a \emph{nested} family of solutions parameterized by the budget $H$: If $H \leq H'$, then the greedy solution for budget $H$ is a subset of the greedy solution for budget $H'$. As Rozanov and Tamir (2020) remark, the knowledge that the optima are nested aids not only in computing the optimal solution, but in the implementation thereof under uncertain information. For example, in the United States, many college applications are due at the beginning of November, and it is typical for students to begin working on their applications during the prior summer because colleges reward students who tailor their essays to the target school. However, students may not know how many schools they can afford to apply to until late October. The nestedness property---or equivalently, the validity of a greedy algorithm---implies that even in the absence of complete budget information, students can begin to carry out the optimal application strategy by writing essays for schools in the order that they enter the optimal portfolio.
\else

For certain classes of optimization problems, such as maximizing a submodular set function over a cardinality constraint, a greedy algorithm is known to be a good approximate solution and exact under certain additional assumptions (Fisher et al. 1978; Assad 1985). For other problems, notably the binary knapsack problem, the most obvious greedy algorithm can be made to perform arbitrarily poorly (Vazirani 2001). We show results for the college application problem that mirror those for the knapsack problem: When each $g_j = 1$, the optimal portfolios are nested. This special case mirrors the centralized college application process in Korea, where there is no application fee, but students are allowed to apply to only three schools during the main admissions cycle. Unfortunately, the nestedness property does not hold in the general case, nor does the greedy algorithm offer any performance guarantee. Instead, we identify a fully polynomial-time approximation scheme (FPTAS) based on fixed-point arithmetic. 

\ifen
Finally, we remark that the objective function of \eqref{headlineproblem} is a nondecreasing submodular function. However, our research employs more elementary analytical techniques, and our approximation results are tighter than those associated with generic submodular maximization algorithms. For example, a well-known result of Fisher et al. (1978) implies that the greedy algorithm is asymptotically $(1 - 1/e)$-optimal for the $g_j = 1$ case of the college application problem, whereas we show that the same algorithm is exact. As for the general problem, an equivalent approximation ratio is achievable when maximizing a submodular set function over a knapsack constraint using a variety of relaxation techniques (Chekuri et al. 2014; Badanidiyuru and Vondrák 2014; Kulik et al. 2013). Indeed, $1 - 1/e$ is the highest approximation coefficient achievable by a polynomial-time algorithm for this problem (Nemhauser and Wolsey 1978). But in the college application problem, the existence of the FPTAS supersedes these results.



\ifen \subsection{Structure of this paper} \else \subsection{본 논문의 구성}\fi
\ifen Section \ref{preliminaries} introduces some additional notation and assumptions that can be imposed without loss of generality. We also introduce a useful variable-elimination technique and prove that the objective function is submodular. 

In Section \ref{homogappcosts}, we consider the special case where each $g_j = 1$ and $H$ is an integer $h \leq m$.  We show that an intuitive heuristic is in fact a $1/h$-approximation algorithm. Then, we show that the optimal portfolios are nested in the budget constraint, which yields an exact algorithm that runs in $O(hm)$ time. 

In Section \ref{hetappcosts}, we turn to the scenario in which colleges differ in their application fees. We show that the decision form of the portfolio optimization problem is NP-complete through a polynomial reduction from the binary knapsack problem. We provide four algorithms for this more general setup. The first is a branch-and-bound routine. The second is a dynamic program that iterates on total expenditures and produces an exact solution in pseudopolynomial time, namely $O(Hm + m \log m)$. The third is a different dynamic program that iterates on truncated portfolio valuations. It yields a fully polynomial-time approximation scheme that produces a $(1 - \varepsilon)$-optimal solution in $O(m^3 / \varepsilon)$ time.  The fourth is a simulated-annealing heuristic algorithm that demonstrates strong performance in our synthetic instances. 

In Section \ref{numericalexperiments}, we present the results of computational experiments that confirm the validity and time complexity results established in the previous two sections. We also investigate the empirical accuracy of the simulated-annealing heuristic.

In the conclusion, we identify possible improvements to our solution algorithms and introduce a few extensions of the model that capture the features of real-world admissions processes.

