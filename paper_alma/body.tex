\section{Introduction}

In the college admissions market, the desirability of a school correlates with its competitiveness, meaning that college application represents a challenging risk allocation problem: Applicants must weigh competitive, attractive ``reach schools'' against less attractive ``safety schools'' where admission is a safer bet. The difficulty of the college application problem, along with the perceived importance of college admissions to future career outcomes, drives demand for a lucrative industry known as admissions consulting. In the US, students pay private consultants an average of \$200 per hour for assistance in preparing application materials, estimating their admissions odds, and deciding which schools to apply to \cite{sklarow2018}. However, when admissions consultants advise their clients on where to apply, they typically rely on qualitative heuristics, such as balancing applications evenly between safety, target, and reach schools \cite{jeon2015,peck2021}. Can a formal statement of the college application problem help us improve upon these heuristics? 

Regression studies of college application behavior have revealed intriguing systematic differences in students' application strategies: High-achieving students from wealthy backgrounds tend to apply to more, and more competitive, colleges than their low-income peers \cite{hartlaubandschneider2012,vanhuizenandalessie2019}. Does this phenomenon reflect underlying psychological differences in students' risk aversion, or rational decisionmaking under different resource constraints? %Framing the college application strategy as an optimization problem allows us to examine the relationship between a student's resource constraints and the optimal risk allocation.

The present study addresses the questions above by formulating the student's college application strategy as the following combinatorial optimization problem:
\begin{align} \label{headlineproblem}
\begin{split}
\text{maximize}\quad & v(\mathcal{X}) =  \operatorname{E}\Bigl[\max\bigr\{t_0,
\max\{t_j Z_j : j \in \mathcal{X}\}\bigr\}\Bigr] \\
\text{subject to}\quad & \mathcal{X} \subseteq \mathcal{C}, ~~|\mathcal{X}| \leq h
\end{split}
\end{align}
Here $\mathcal{C} = \{ 1 \dots m\}$ represents the set of colleges in the market and $h > 0$ is the number of colleges the student can apply to. For $j = 1 \dots m$, let $f_j$ denote the student's probability of being admitted to school $j$ if she applies and $Z_j$ a random, independent Bernoulli variable with probability $f_j$, so that $Z_j$ equals one if she is admitted and zero if not. It is appropriate to assume that the $Z_j$ are statistically independent as long as $f_j$ are probabilities estimated specifically for this student (as opposed to generic acceptance rates). For $j = 0\dots m$, $t_j\geq 0$ indicates the utility she associates with attending school $j$, where her utility is $t_0$ if she does not attend college. Then the student's objective is to maximize the expected utility associated with the best school she is admitted to. Therefore, her optimal college application strategy is given by the solution $\mathcal{X}$ to the problem above, where $\mathcal{X}$ represents the set of schools to which she applies, which we call her application \emph{portfolio.}

The problem can also be applied to other competitive matching games such as job application or marriage proposals. Here the budget constraint may arise due to the time required to communicate with each applicant or a legal limit on the number of applications allowed.

We show that the optimal portfolios for the cardinality-constrained college are \emph{nested} in the budget constraint, meaning that when $\mathcal{X}_h$ is the optimal portfolio of size $h$, $\mathcal{X}_h \subset \mathcal{X}_{h+1}$. The nestedness property is equivalent to the optimality of the \emph{greedy} algorithm that iteratively adds to $\mathcal{X}$ the school that elicits the greatest increase in the objective value. The proof of the nestedness property yields insight into the properties of the optimal college application strategy: Students who cannot afford to apply to many schools allocate a greater proportion of their application budget to safety schools than students with a large application budget. This phenomenon, which we call optimal risk elasticity, reveals a shortcoming of the reach/safety school heuristics used in the admissions consulting industry: Whereas admissions consultants recommend a \emph{static} risk allocation that allocates a fixed proportion of the portfolio to reach, target, and safety schools, we find that the optimal application strategy gradually favors reach schools over safety schools as $h$ increases. Optimal risk elasticity therefore provides a rational explanation for the divergent risk behavior observed in the social science research cited above: It may not be the case that low-income students are inherently more risk-averse than their wealthy peers, but rather, their constrained budget induces a more risk-averse optimal policy. 

Our analysis also shows that the valuation of the college application problem is sublinear in the budget $h$, and that the shadow cost of the budget constraint is highest for students with low admissions probability at the schools currently in their portfolio. This finding suggests an economic explanation for the underwhelming efficacy of behavioral nudges, such as application fee waivers, designed to encourage talented low-income students to apply to selective universities \cite{gurantzetal2021}. 

\subsection{Related optimization problems}

The objective function of \eqref{headlineproblem} is a nondecreasing, submodular set function in the sense first described by Nemhauser et al. \cite{nemhauseretal1978}. They showed that the greedy algorithm is asymptotically $(1 - 1/e)$-optimal for optimizing a monotonic submodular function over a cardinality constraint, and a subsequent result of Nemhauser and Wolsey \cite{nemhauserandwolsey1978} proved that this approximation ratio is the best achievable by a polynomial-time algorithm. For some submodular optimization problems, however, the same greedy algorithm offers a much tighter approximation guarantee \cite{contrerasandfernandez2014}. We show that college application represents an easy instance of submodular maximization: The greedy algorithm is exact.

The proof of the greedy algorithm's optimality rests on the nested structure of the optimal portfolios, a property that is of independent interest. As Rozanov and Tamir \cite{rozanovandtamir2020} articulate, the knowledge that the optima are nested aids not only in computing the optimal solution, but in the implementation thereof under uncertain information. For example, in the United States, many college applications are due at the beginning of November, and it is typical for students to begin working on their applications during the prior summer because colleges favor students who tailor their essays to the target school. However, students may not know how many schools they can afford to apply to until late October. The nestedness property implies that even in the absence of complete budget information, students can begin to carry out the optimal application strategy by writing essays for schools in the order that they enter the optimal portfolio.

The college application problem can be viewed as a static variant of the Pandora's Box problem \cite{weitzman1979,boodaghiansetal2022}. In a Pandora's Box formulation of college application, the student applies to schools one by one, each time paying an application fee and observing her admissions outcome after a certain time delay. The problem is to determine an optimal \emph{stopping rule} for when Pandora should halt her college search and accept the best admissions offer she has on hand. Weitzman \cite{weitzman1979} showed that the optimal policy is to stop searching when the value of the current best offer exceeds the maximum \emph{reservation price,} a statistic that represents the expected value of applying to a new college.

Arguably, the static model considered in this study is more hostile to students than the Pandora's Box problem. If, for example, an unlucky Pandora is rejected from a safety school at an early round of application, then she can compensate for the unexpected loss by pivoting to a more risk-averse application strategy. By contrast, the decisionmaker in our college application problem must commit at the outset to applying to every school in her application portfolio. The admissions process used in the United States can be viewed as the concatenation of both problems: In the fall, students solve \eqref{headlineproblem} and send out a batch of applications. Then, upon observing their admissions outcomes in March, they use the Pandora strategy to pursue additional offers by applying to schools that offer rolling admissions.

\subsection{Admissions markets}

Most quantitative research on college admissions to date has been descriptive in nature. A standard benchmark for logistic regression techniques, for example, involves estimating students' admissions probabilities from information about their past academic performance \cite{acharyaetal2019,lim2013}. 

%Fu \cite{fu2014} considered a problem that is reducible to ours: Since application is at cost rather than a constraint, the objective function is separable in the cost and therefore must be optimal over portfolios of the given size. Thus, solving her problem reduces to solving $m$ instances of \eqref{headlineproblem}.

Some economists have constructed equilibrium models of college admissions that feature the student's application decision as a prominent subproblem. For example, a problem reducible to ours arose in a sequential game model of the United States college market by Fu \cite{fu2014}. (We describe the reduction in section \ref{sectionQuadTimeSoln}.) However, to ensure the robustness of her parameter estimates, Fu clustered the colleges in the market into $m=8$ broad categories, yielding a small instance that could be solved by enumerating all $2^m$ possible portfolios. Our solution algorithm computes the optimal portfolio in time quadratic in $m$. 

The literature on admissions markets also includes a vast body of research on the deferred acceptance algorithm, an algorithm for matching students and schools that generalizes the Gale--Shapley algorithm for stable marriage. The algorithm takes students' ordinal preferences over schools and schools' ordinal preferences over students as input, and produces an assignment that possesses a number of desirable properties: It is a stable matching, meaning that no student--school pair is incentivized to deviate from the assignment. And the preference-reporting mechanism is incentive compatible, meaning that no student can improve her outcome by lying about her preferences \cite{galeandshapley1962,roth1982}. In design, deferred acceptance is a centralized assignment algorithm; however, stable assignment also be interpreted as the equilibrium of a decentralized admissions game in which agents possess perfect information about one another's preferences \cite{azevedoandleshno2016}.

The utility model implied by stable assignment differs from that of the present study in two key ways: First, under stable assignment, students' preferences are ordinal, rather than cardinal (although it is possible to estimate cardinal utility values from stable matchings in certain special cases, such as when colleges' preferences are identical and students' preferences are determined by the multinomial logit choice model \cite{kapur2021}). Second, stable assignment is deterministic: The typical student-proposing deferred acceptance algorithm always produces the unique, student-optimal stable assignment. There exist variants of the deferred acceptance algorithm that introduce randomization in order to break ties in schools' preference lists or optimize for distributional goals such as gender parity, but because the randomization occurs after students submit their preferences, it has no effect on the optimal application strategy, which remains to report one's preferences honestly \cite{ashlagiandnikzad2020,bodohcreed2020}. In the admissions process considered in this study, students face a tougher strategic challenge.

To the best of our knowledge, the first systematic study of the college application problem was Kapur's master's thesis \cite{kapur2022}, which considered \eqref{headlineproblem} as well as the more general case of college application with a knapsack constraint. The present study extends Kapur's results with an analysis of heuristics used in the admissions consulting industry and the implications of the nestedness and submodularity properties for student welfare.

\subsection{Outline}

This paper has five sections. In section \ref{sectionModel}, we derive a closed-form expression for the objective function of \eqref{headlineproblem}, show that it is a monotonic submodular function, and state a technical lemma. In section \ref{sectionGreedy}, we prove that the optimal portfolios are nested in the budget $h$, which implies the validity of the greedy algorithm. Further refinement reduces the algorithm's computation time from $O(h^2 m + m\log m)$ to $O(hm)$. In section \ref{sectionDiscussion}, we examine heuristic solution mechanisms used in the admissions consulting industry, assess their performance relative to the optimal solution, and offer a few conjectures concerning policy interventions to improve student equity. A brief conclusion follows in section \ref{sectionConclusion}.







\section{Preliminaries} \label{sectionModel}

For the remainder of the paper, unless otherwise noted, we assume with minimal loss of generality that $0 < h \leq m$, $f_j \in (0, 1]$, and $t_0 < t_1 \leq \cdots \leq t_m$. Unless otherwise noted, we assume $t_0 = 0$, an assumption justified presently. 
% Lots of overlap here with paper_ellis; edit there first and then import

\subsection{The objective function} \label{sectionObjective}

First we derive a closed-form expression for the objective function of \eqref{headlineproblem}.

We refer to the set $\mathcal{X} \subseteq \mathcal{C}$ of schools to which a student applies as her \emph{application portfolio.} The expected utility the student receives from $\mathcal{X}$ is called its \emph{valuation}. Given an application portfolio, let $p_j(\mathcal{X})$ denote the probability that the student attends school $j$. This occurs if and only if she \emph{applies} to school $j$, is \emph{admitted} to school $j$, and is \emph{rejected} from any school she prefers to $j$; that is, any school with higher index. Hence, for $j= 0\dots m$,
\begin{align*}
p_j(\mathcal{X}) &= 
\begin{cases}
\displaystyle f_j  \prod_{\substack{i \in \mathcal{X}: \\ i > j}} (1 - f_{i}), \quad & j \in \{0\}\cup\mathcal{X}\\
0, \quad & \text{otherwise}
\end{cases} 
\end{align*}
The following proposition follows by computing $v(\mathcal{X}) = \sum_{j=0}^m  t_j p_j(\mathcal{X})$.
\begin{proposition}[Closed form of portfolio valuation function]
\begin{align*}
v(\mathcal{X}) &= \sum_{j=0}^m t_j p_j(\mathcal{X}) = \sum_{j\in\{0\}\cup\mathcal{X}} \Bigl( f_j t_j \prod_{\substack{i \in \mathcal{X}: \\ i > j}} (1 - f_{i}) \Bigr)  \label{closedformportfoliovaluationX}%, \quad \text{or equivalently,}\\
%\qquad v(x) &= t_0 \prod_{j=1}^m (1 - f_{j} x_j) + \sum_{j=1}^m \Bigl( x_j t_j f_j \prod_{j’ = j+1}^m (1 - f_{j’} x_{j’}) \Bigr) \label{closedformportfoliovaluationx}
\end{align*}
\end{proposition}

Next, we show that without loss of generality, we may assume that $t_0 = 0$.

\begin{lemma} \label{assumetzerozero}
For some $\gamma \leq t_0$, let $\bar t_j = t_j - \gamma$ for $j = 0 \dots m$. Then $v(\mathcal{X}; \bar t_j) = v(\mathcal{X};  t_j) -  \gamma$ for any $\mathcal{X} \subseteq \mathcal{C}$. 
\end{lemma}
\begin{proof}
By definition, $\sum_{j=0}^m p_j(\mathcal{X}) = \sum_{j \in \{0\}\cup\mathcal{X}} p_j(\mathcal{X}) = 1$. Therefore
\begin{align*}
\begin{split}
v(\mathcal{X}; \bar t_j) &= \sum_{j\in \{0\}\cup\mathcal{X}}  \bar t_j p_j(\mathcal{X})
=\sum_{j\in \{0\}\cup\mathcal{X}} (t_j - \gamma) p_j(\mathcal{X}) \\
&=\sum_{j\in \{0\}\cup\mathcal{X}} t_j p_j(\mathcal{X})  - \gamma 
= v(\mathcal{X}; t_j) - \gamma
\end{split} 
\end{align*}
which completes the proof.
\end{proof}


\subsection{An elimination technique} \label{eliminationtechniquesection}

Now, we present a variable elimination technique that will prove useful throughout the paper. Suppose that the student has already resolved to apply to school $k$, and the remainder of her decision consists of determining which \emph{other} schools to apply to. Writing her total application portfolio as $\mathcal{X} = \mathcal{Y} \cup \{k\}$, we devise a function $w(\mathcal{Y})$ that orders portfolios according to how well they ``complement'' the singleton portfolio $\{k\}$. Specifically, the difference between $v(\mathcal{Y} \cup\{k\})$ and $w(\mathcal{Y})$ is the constant $f_k t_k$.

To construct $w(\mathcal{Y})$, let $\tilde t_j$ denote the expected utility the student receives from school $j$ \emph{given} that she has been admitted to school $j$ and applied to school $k$. For $j < k$ (including $j = 0$), this is $\tilde t_j = (1- f_k) t_j + f_k t_k$; for $j > k $, this is $\tilde t_j = t_j$. This means that 
\begin{equation}\label{Vyastildet}
v(\mathcal{Y}\cup\{k\}) = \sum_{j \in \{0\} \cup \mathcal{Y}} \tilde t_j p_j(\mathcal{Y}).\end{equation}
The transformation to $\tilde t$ does not change the order of the $t_j$-values. Therefore, the expression on the right side of \eqref{Vyastildet} is itself a portfolio valuation function. In the corresponding market, $t$ is replaced by $\tilde t$ and $\mathcal{C}$ is replaced by $\mathcal{C}\setminus\{k\}$. To restore our convention that $t_0 = 0$, we obtain $w(\mathcal{Y})$ by taking $\bar t_j = \tilde t_j - \tilde t_0$ for all $j \neq k$ and letting
\begin{equation*} 
w(\mathcal{Y})
= \sum_{j \in \{0\} \cup \mathcal{Y}} \bar t_j p_j(\mathcal{Y})
= \sum_{j \in \{0\} \cup \mathcal{Y}} \tilde t_j p_j(\mathcal{Y})- \tilde t_0
= v(\mathcal{Y}\cup\{k\}) - f_k t_k
\end{equation*}
where the second equality follows from Lemma \ref{assumetzerozero}. The validity of this transformation is summarized in the following theorem, where we write $v(\mathcal{X}; \bar t)$ instead of $w(\mathcal{Y})$ to emphasize that $w(\mathcal{Y})$ is, in form, a portfolio valuation function. 


\begin{lemma}[Eliminate school $k$] \label{eliminationtheorem}
For $\mathcal{X} \subseteq \mathcal{C} \setminus \{k\}$, $v(\mathcal{X}\cup\{k\}; t)  = v(\mathcal{X}; \bar t) + f_k t_k$, where
\begin{align}\label{howtotransformtj}
\bar t_j = 
\begin{cases}
(1 - f_k) t_j, \quad & t_j \leq t_k \\
t_j - f_k t_k, \quad& t_j > t_k.
\end{cases}
\end{align}
\end{lemma}

\begin{proof}
It is easy to verify that \eqref{howtotransformtj} is the composition of the two transformations (from $t$ to $\tilde t$, and from $\tilde t$ to $\bar t$) discussed above.
\end{proof}

%\noindent The transformation \eqref{howtotransformtj} can be applied iteratively to accommodate the case where the student has already resolved to apply to multiple schools.




\subsection{Submodularity of the objective}

Now, we show that the portfolio valuation function is submodular. This result is primarily of taxonomical interest and may be safely skipped, as our subsequent results do not rely on submodular analysis. 

\begin{definition}[Submodular set function]
Given a ground set $\mathcal{C}$ and function $v : 2^{\mathcal{C}} \mapsto \mathbb{R}$, $v(\mathcal{X})$ is called a \emph{submodular set function} if and only if $v(\mathcal{X}) + v(\mathcal{Y}) \geq v(\mathcal{X}\cup\mathcal{Y}) + v(\mathcal{X}\cap\mathcal{Y})$
for all $\mathcal{X}, \mathcal{Y} \subseteq \mathcal{C}$. Furthermore, if $ v(\mathcal{X}\cup\{k\}) - v(\mathcal{X}) \geq 0$ for all $\mathcal{X} \subset \mathcal{C}$ and $k \in \mathcal{C} \setminus \mathcal{X}$, $v(\mathcal{X})$ is said to be a \emph{nondecreasing} submodular set function.
\end{definition}

\begin{theorem}
The college application portfolio valuation function
$v(\mathcal{X})$ % = \sum_{j\in\mathcal{X}} \Bigl( f_j t_j \prod_{\substack{i \in \mathcal{X}: \\ i > j}} (1 - f_{i}) \Bigr)\]
is a nondecreasing submodular set function.
\end{theorem}

\begin{proof}
It is self-evident that $v(\mathcal{X})$ is nondecreasing. To establish its submodularity, we apply proposition 2.1.iii of \cite{nemhauserandwolsey1978} and show that
\begin{equation}\label{nemhauseriii}
v(\mathcal{X} \cup \{j\}) - v(\mathcal{X}) \geq 
v(\mathcal{X} \cup \{j, k\}) - v(\mathcal{X} \cup \{k\})
\end{equation}
for $\mathcal{X} \subset \mathcal{C}$ and $j \neq k \in \mathcal{C} \setminus \mathcal{X}$. By Lemma \ref{eliminationtheorem}, we can repeatedly eliminate the schools in $\mathcal{X}$ according to \eqref{howtotransformtj} to obtain a portfolio valuation function $w(\mathcal{Y})$ with parameter $\bar t$ such that $w(\mathcal{Y}) = v(\mathcal{X} \cup \mathcal{Y}) + \text{const.}$ for any $\mathcal{Y} \subseteq \mathcal{C} \setminus \mathcal{X}$. Therefore, \eqref{nemhauseriii} is equivalent to
\begin{align*}
& w(\{j\}) - w(\varnothing) \geq w(\{j, k\}) - w(\{k\}) \\
\iff \qquad &w(\{j\})  +  w(\{k\})  \geq w(\{j, k\})  \\
\iff \qquad &\operatorname{E}[\,\bar t_j Z_j\,] + \operatorname{E}[\,\bar t_k Z_k\,] 
\geq \operatorname{E}\bigl[\max\{ \bar t_j Z_j, \bar t_k Z_k \} \bigr]
\end{align*}
which is true because $t_j$ and $t_k$ are nonnegative.
\end{proof}











\section{The greedy algorithm} \label{sectionGreedy}

\subsection{The nestedness property} 
The optimality of the greedy algorithm for the college application problem rests on the fact the the optimal solution possesses a special structure: An optimal portfolio of size $h+1$ includes an optimal portfolio of size $h$ as a subset.

\begin{theorem}[Nestedness of optimal application portfolios] \label{nestedapplication}
There exists a sequence of portfolios $\{\mathcal{X}_h\}_{h=1}^m$ satisfying the nestedness relation
\begin{equation*}
\mathcal{X}_1 \subset \mathcal{X}_2\subset \dots \subset \mathcal{X}_m
\end{equation*}
such that each $\mathcal{X}_h$ is an optimal application portfolio when the application limit is $h$.
\end{theorem}

\begin{proof}
By induction on $h$. Applying Lemma \ref{assumetzerozero}, we assume that $t_0 = 0$. 

(Base case.) First, we will show that $\mathcal{X}_1 \subset \mathcal{X}_2$. To get a contradiction, suppose that the optima are $\mathcal{X}_1 = \{j\}$ and $\mathcal{X}_2 = \{k, l\}$, where we may assume that $t_k \leq t_l$. Optimality requires that

\begin{equation*}
v(\mathcal{X}_1 )  = f_j t_j > v(\{k\}) = f_k t_k
\end{equation*}
and
\begin{align*}
\begin{split}
v(\mathcal{X}_2) =  f_k (1- f_l) t_k + f_l t_l &> v(\{j, l\}) \\
& = f_j (1- f_l) t_j + (1- f_j) f_l t_l + f_j f_l \max\{t_j, t_l\} \\
&\geq  f_j (1- f_l) t_j + (1- f_j) f_l t_l + f_j f_l  t_l \\
&= f_j (1- f_l) t_j + f_l t_l  \\
&\geq f_k (1- f_l) t_k + f_l t_l  = v(\mathcal{X}_2)
\end{split}
\end{align*}
which is a contradiction. 

(Inductive step.) Assume that $\mathcal{X}_1 \subset \cdots \subset \mathcal{X}_h$, and we will show $\mathcal{X}_h \subset \mathcal{X}_{h+1}$. Let $k = \argmax\{ t_k: k \in \mathcal{X}_{h+1}\}$ and write $\mathcal{X}_{h+1} = \mathcal{Y}_{h} \cup \{k\}$.

Suppose $k \notin \mathcal{X}_h$. To get a contradiction, suppose that $v(\mathcal{Y}_h) < v(\mathcal{X}_h)$ and  $v(\mathcal{X}_{h+1}) > v(\mathcal{X}_h \cup \{k\})$. Then
\begin{align*}
\begin{split}
v(\mathcal{X}_{h+1})&= v(\mathcal{Y}_{h} \cup \{k\}) \\
&= (1 - f_k) v(\mathcal{Y}_h) + f_k t_k \\
&\leq (1 - f_k) v(\mathcal{X}_h) + f_k \operatorname{E}\bigl[ \max\{t_k, X_h\}\bigr]\\
&=  v(\mathcal{X}_h\cup \{k\})
\end{split}
\end{align*}
is a contradiction.

Now suppose that $k \in \mathcal{X}_h$. We can write $\mathcal{X}_h = \mathcal{Y}_{h-1} \cup \{k\}$, where $ \mathcal{Y}_{h-1}$ is some portfolio of size $h-1$. It suffices to show that $ \mathcal{Y}_{h-1} \subset \mathcal{Y}_h$. By definition, $\mathcal{Y}_{h-1}$ (respectively, $\mathcal{Y}_{h}$) maximizes the function $v(\mathcal{Y}\cup\{k\})$ over portfolios of size $h-1$ (respectively, $h$) that do not include $k$. That is, $\mathcal{Y}_{h-1}$ and $\mathcal{Y}_h$ are the optimal complements to the singleton portfolio $\{k\}$.

Applying Lemma \ref{eliminationtheorem}, we eliminate school $k$, transform the remaining $t_j$-values to $\bar t_j$ according to \eqref{howtotransformtj}, and obtain a function $w(\mathcal{Y}) = v(\mathcal{Y} \cup \{k\}) - f_k t_k$ that grades portfolios $\mathcal{Y} \subseteq \mathcal{C} \setminus \{k\}$ according to how well they complement $\{k\}$. Since $w(\mathcal{Y})$ is itself a portfolio valuation function and $\bar t_0 = 0$, the inductive hypothesis implies that $\mathcal{Y}_{h-1} \subset \mathcal{Y}_h$, which completes the proof.
\end{proof}




\subsection{Quadratic-time solution} \label{sectionQuadTimeSoln}

Applying Theorem \ref{nestedapplication} yields an efficient greedy algorithm for the optimal portfolio: Start with the empty set and add schools one at a time, maximizing $v(\mathcal{X}\cup \{k\})$ at each addition. Sorting $t$ is  $O(m \log m)$.  At each of the $h$ iterations, there are $O(m)$ candidates for $k$, and computing $v(\mathcal{X}\cup \{k\})$ is $O(h)$; therefore, the time complexity of this algorithm is $O(h^2 m + m \log m)$. 

We reduce the computation time to $O(hm)$ by taking advantage of the transformation from Lemma \ref{eliminationtheorem}. Once school $k$ is added to $\mathcal{X}$, we eliminate it from the set $\mathcal{C}\setminus \mathcal{X}$ of candidates, and update the $t_j$-values of the remaining schools according to \eqref{howtotransformtj}. Now, the \emph{next} school added must be the optimal singleton portfolio in the modified market. But the optimal singleton portfolio consists simply of the school with the highest value of $f_j \bar t_j$. Therefore, by updating the $t_j$-values at each iteration according to \eqref{howtotransformtj}, we eliminate the need to compute $v(\mathcal{X})$ entirely. Moreover, this algorithm does not require the schools to be indexed in ascending order by $t_j$, which removes the $O(m\log m)$ sorting cost.

\begin{algorithm}[h] 
%\DontPrintSemicolon
\caption{Optimal portfolio algorithm for the college application problem.} \label{algorithmforlargeh}
\KwIn{Utility values $t \in(0, \infty)^m$, admissions probabilities $f \in (0, 1]^m$, application limit $h \leq m$.}
$\mathcal{C} \gets \{1 \dots m\}$\;
$\mathtt{X, V} \gets $ empty $h$-arrays\;
\For{$i=1\dots h$}
{
    $k \gets \argmax_{j \in \mathcal{C}}\{f_j t_j\}$\;
    $\mathcal{C} \gets \mathcal{C} \setminus \{k\}$\;
    $\mathtt{X}[i] \gets k$\;
     \lIfElse{$i=1$}{$\mathtt{V}[i] \gets f_k t_k$}
     {$\mathtt{V}[i] \gets \mathtt{V}[i-1] + f_k t_k$}
    \For{$j \in \mathcal{C}$}
	{
	\lIfElse{$t_j \leq t_k$}{$t_j \gets (1 -  f_k) t_j $}{$t_j \gets  t_j -  f_k t_k$}
	}
}
\Return{$\mathtt{X, V}$}
\end{algorithm}


\begin{theorem}[Validity of Algorithm \ref{algorithmforlargeh}] \label{validityofalmaalgorithm}
Algorithm \ref{algorithmforlargeh} produces an optimal application portfolio for the cardinality-constrained college application problem in $O(h m)$ time.
\end{theorem}

\begin{proof}
Optimality follows from the proof of Theorem \ref{nestedapplication}. At each of the $h$ iterations of the main loop, finding the top school costs $O(m)$, and the $t_j$-values of the remaining $O(m)$ schools are each updated in unit time. Therefore, the overall time complexity is $O(h m)$.
\end{proof}

By running Algorithm \ref{algorithmforlargeh} with $h = m$, one can obtain the optimal portfolios for \emph{all} $h$ by taking $\mathcal{X}_h = \{ \mathtt{X}[1], \dots, \mathtt{X}[h]\}$. Thus, a trivial modification of the algorithm yields $O(m^2)$-time solution for Fu (2014)'s variant of the college application problem, stated as 
\[ \text{maximize} \quad v(\mathcal{X}) - c(|\mathcal{X}|)\]
where $c(\cdot)$ is an increasing cost function. By separability, the optimal portfolio in this problem must be optimal over portfolios of the same size. Hence, it suffices to compute
\[h^* = \argmax_{h = 1 \dots m} \bigl\{\mathtt{V}[h] - c(h)\bigr\}\] and return $\mathcal{X}_{h^*}$.  

Kapur \cite{kapur2022} describes two implementations of Algorithm \ref{algorithmforlargeh} in the Julia language and provides performance benchmarks.





\section{Discussion: Heuristics and student welfare} \label{sectionDiscussion}

% Marshmallow test: 
% original study: shodaetal1990
% Correlation with socioeconomic status: wattsetal2018
% Environmental reliability hypothesis (rational explanation): kiddetal2013

\subsection{The distributional heuristic and optimal risk elasticity}

The college application problem is relatively easy when the applicant can identify schools that have both high admissions probability $f_j$ and high utility $t_j$. In typical admissions markets, however, $f_j$ and $t_j$ correlate inversely, because desirable schools attract greater numbers of applicants. Students must make tough dichotomous decisions between schools that have similar expected utility but different risk profiles. Many admissions consultants therefore advise applicants to allocate applications evenly across reach, target, and safety schools \cite{jeon2015,peck2021}. How does this \emph{distributional heuristic} perform compared to the optimal application strategy?

The distributional heuristic does not specify the boundary between target, safety, and reach schools. However, regardless of how this boundary is specified, we argue that the distributional heuristic is limited by the fact that it does not respond adaptively to the application budget $h$. In a market where $f_j$ and $t_j$ are inversely correlated, we find that the first schools to enter the optimal portfolio in the greedy algorithm are safety schools, and the allocation shifts to incorporate more target and reach schools as the application budget $h$ grows. This phenomenon, which we call \emph{optimal risk elasticity,} implies that any heuristic that targets a \emph{static} risk distribution becomes excessively risk averse for students with a sufficiently large application budget. Students with a large application budget can tolerate, and indeed benefit, from taking larger risks than those without.

To see why large values of $h$ favor a riskier portfolio allocation, consider two schools $i$ and $j$ having $t_i < t_j$ and $f_i t_i = f_j t_j = 1$. Thus, the expected utility of applying \emph{individually} to either school is identical, and a risk-neutral student is indifferent between the safety school $i$ and the reach school $j$. Now suppose that the student has resolved to apply to another school, $k$, and the question is whether to apply to  $\mathcal{X} = \{i, k\}$ or $\{j, k\}$. There are three cases:

\begin{itemize}
\item If $t_k \leq t_i < t_j$, then 
\begin{align*}
v(\{i, k\}) -  v(\{j, k\}) &= (1 - f_i) f_k t_k  + f_i t_i - (1 - f_j) f_k t_k - f_j t_j \\
&=  - f_i f_k t_k + f_j f_k t_k &< 0
\end{align*}
because $f_i > f_j$. 
\item If  $t_i \leq t_k \leq t_j$, then 
\begin{align*}
v(\{i, k\}) -  v(\{j, k\}) &= (1 - f_k ) f_i t_i + f_k t_k - (1 - f_j) f_k t_k - f_j t_j \\
&= (1 - f_k) + f_k t_k - \bigl( 1 - \frac{1}{t_j}\bigr) f_k t_k - 1  \\
&=  - f_k + \frac{1}{t_j} f_k t_k & \leq 0
\end{align*}
because $t_k \leq t_j$.
\item If $t_i < t_j \leq t_k$, then 
\begin{align*}
v(\{i, k\}) -  v(\{j, k\}) &=  (1 - f_k) f_i t_i + f_k t_k - (1 - f_k) f_j t_j - f_k t_k &= 0.
\end{align*}
\end{itemize}

\noindent In every case, it is (weakly) optimal to choose the reach school $j$ over the safety school $i$. Thus, however one defines a ``target school,'' it is always better to pair a target school with a reach school than with a safety school as long as the choices are equivalent in their actuarial value. By the elimination argument, one can show that the same result holds with respect to adding a reach or safety school to a portfolio that is otherwise balanced.

\subsection{Implications of optimal risk elasticity for econometric research}

Optimal risk elasticity differentiates the college application problem from classical portfolio optimization models in the Markowitz \cite{markowitz1952} tradition, which feature risk aversion as an exogeneous \emph{parameter.} In the Markowitz model, the optimal portfolio is expressed as a proportion of the total budget, and this allocation is constant for budgets of all sizes. Therefore, the value of a rational investor's risk parameter can be determined by locating her portfolio allocation along the efficient frontier---even if her total investment budget is unknown. In college application, on the other hand, variation in students' risk allocation arises from a combination of variance in underlying risk preferences and variance in students' application budgets. 

Our formulation of the college application problem has presumed a risk-neutral student who maximizes her portfolio's expected value without regard to its variance. Is this model sufficiently complex to model the psychology of real college applicants? Perhaps not: Regression studies of college applicant behavior have shown that low-income students tend to apply to a few safety schools, whereas their wealthy peers tend to apply to more schools and take bigger risks \cite{hoxbyandavery2012}. One interpretation of these findings is as part of a larger pattern of greater risk aversion in those from disadvantaged backgrounds, a finding that has been noted in other areas of psychological research \cite{hartlaubandschneider2012,wattsetal2018,vanhuizenandalessie2019}. Adding a variance penalty to the objective function could improve our model's ability to capture real student behavior.

% state the model

% Move to conclusion
% A potential application of our model is an econometric study that estimates students' perceptions of college quality ($t_j$) from their observed application behavior ($\mathcal{X}$) under the assumption of utility maximization. In the econometric context, adding a variance penalty to the objective function could improve our model's ability to capture real student behavior. However, the caveat is that you need to control for budget size

% However, after you regress the enhanced model on real data, you might still find the risk aversion parameter
However, optimal risk elasticity suggests a rational basis for low-income students' apparent risk aversion in the college application process: For a student with a small application budget, even one with zero risk aversion, applying to a few safety schools is often the \emph{optimal} strategy. % and students have same $t_j - t_0$
Thus, to the extent that low-income students have smaller application budgets than their wealthy peers, the fact that students \emph{appear} to differ systematically in their risk preferences may be merely an artifact of underlying differences in application resources. Therefore, we propose that future econometric studies of college application control for the size of the application portfolio before attributing variance in students' allocation across reach, target, and safety schools to variance in psychological risk aversion. % word this last sentence more politely


\subsection{Diminishing returns to application and equity interventions}

Diminishing returns are an intrinsic feature of submodular set functions. The college application problem is no exception, as the following theorem states.

\begin{theorem} \label{concavityinh}
For $h = 2 \dots (m-1)$,
\begin{equation*}
v(\mathcal{X}_h) - v(\mathcal{X}_{h-1}) \geq v(\mathcal{X}_{h+1}) - v(\mathcal{X}_{h}).
\end{equation*} 
\end{theorem}

\begin{proof}
Applying Theorem \ref{nestedapplication}, we write $\mathcal{X}_h = \mathcal{X}_{h-1} \cup\{j\}$ and $\mathcal{X}_{h+1} = \mathcal{X}_{h-1} \cup\{j, k\}$. By optimality, $v(\mathcal{X}_h) - v(\mathcal{X}_{h-1}) \geq v(\mathcal{X}_{h-1}\cup\{k\}) - v(\mathcal{X}_{h-1})$. By submodularity and nestedness, $v(\mathcal{X}_{h-1}\cup\{k\}) - v(\mathcal{X}_{h-1}) \geq  v(\mathcal{X}_{h}\cup\{k\}) - v(\mathcal{X}_{h}) = v(\mathcal{X}_{h+1}) - v(\mathcal{X}_{h})$.
\end{proof}

\noindent (An elementary proof appears in \cite{kapur2022}.) It follows that when $\mathcal{X}_h$ is the optimal $h$-portfolio, for fixed values of $f$ and $t$, $v(\mathcal{X}_h) = t_0 + O(h)$. The following example establishes the tightness of this bound.

\begin{example} \label{tightexampleforconcavity}
For a small constant $\varepsilon \in (0, 1)$, define the market as follows.
\begin{center}
\begin{tabular}{r|cccccccc}
$j$   & $1$ & $2$ & $\cdots$ & $m-1$ & $m$ \\ \hline
$f_j$ & $\varepsilon^{1}$ & $\varepsilon^{2}$ & $\cdots$ & $\varepsilon^{m-1}$ & $\varepsilon^{m}$ \\
$t_j$ & $\varepsilon^{-1}$ & $\varepsilon^{-2}$ & $\cdots$ & $\varepsilon^{-(m-1)}$ & $\varepsilon^{-m}$
\end{tabular}%
\end{center}
The optimal portfolios are given by $\mathcal{X}_h = \{m-h + 1, \dots, m\}$, and 
\begin{equation*}
v(\mathcal{X}_h) = \sum_{j= m-h +1}^m \Bigl( f_j t_j \prod_{i = j+1}^m (1 - f_{i}) \Bigr) =  \sum_{j= 1}^h  (1 - \varepsilon)^{j-1}.
\end{equation*}
Thus, as $\varepsilon$ approaches zero, we have $v(\mathcal{X}_h) \to h$.
\end{example}

In Example \ref{tightexampleforconcavity}, the ability of the student to achieve a valuation linear in $h$ hinges on the fact that the admissions probabilities $f_j$ are very small; when some schools have $f_j$ close to one, the valuation function tends to flatten out as these schools are incorporated into the optimal portfolio. This means that students with many reach schools in their portfolio benefit more from the opportunity to apply to an additional college than students with many safety schools.

As mentioned above, high-achieving, low-income students tend to self-select out of applying to competitive universities, and many scholars have proposed interventions such as application fee waivers to encourage these so-called  ``one-off'' students to expand their application portfolio \cite{hoxbyandavery2012,hoxbyandturner2013}. However, experiments on nudges such as fee waivers and deadline reminders have elicited somewhat underwhelming results: Students who receive nudges did apply to more colleges, but their enrollment patterns did not change relative to a control group \cite{gurantzetal2021}. Our analysis of the college application problem suggests that these interventions may limit their efficacy by narrowly targeting high-achieving, low-income students. While the opportunity to apply to more schools benefits all students, the students who stand to gain the most are not necessarily high achievers, but rather students of middling ability who are nonetheless qualified for college. For these students, every school is (in a relative sense) a ``reach school,'' and each additional application substantially increases the chance of getting into \emph{somewhere.} Therefore, we speculate that broad interventions to decrease the costs of application, such as direct admission \cite{jaschik2022} (in which colleges offer proactive admission to high school students who meet certain minimal requirements), may yield better equity outcomes than nudges targeted to low-income, high-achieving students.

% I like certain aspects of the wording here but I think the sequence of ideas in the par. above is clearer
% The fact that $v(\mathcal{X}_h)$ grows sublinearly in $h$ may provide an economic explanation for the underwhelming efficacy of behavioral nudges, such as application fee waivers, designed to encourage talented low-income students to apply to selective universities \cite{gurantzetal2021}. In our model, the marginal value of an additional college application is greatest to students who have both a small application portfolio, and small admissions odds at the schools they are currently applying to---that is, students whose portolio allocation is skewed toward reach schools. However, fee-waiver interventions have typically targeted high-achieving, low-income students (so-called ``one-offs'' \cite{hoxbyandavery2012,hoxbyandturner2013}) who already have high admissions odds at the schools in their portfolio due a combination of underlying academic talent and the aforementioned tendency of low-income students to favor safety schools. Therefore, our analysis suggests that the students who stand to benefit the most from nudges such as fee waivers are not high-achieving, low-income students, but rather students of middling ability who are prepared for college but unlikely to be admitted to every school. 




\section{Conclusion} \label{sectionConclusion}

This paper has analyzed a novel submodular optimization problem called the college application problem. When optimizing over a cardinality constraint, we have shown that the optimal portfolios satisfy a nestedness property that implies the optimality of a simple greedy algorithm. We found that the problem exhibits optimal risk elasticity: Students with large budgets should apply to more reach schools than students without. This finding suggests a rational explanation for the apparent risk aversion of low-income students in the college application process. Additionally, the sublinearity of the valuation function suggests that broad interventions to remove barriers to college application may promote greater student equity than programs narrowly targeted to low-income, high-achieving students.

There is ample room to extend the college application problem to more complex constraint structures, such as matroids, knapsacks, and their intersections. For example, a knapsack constraint can model the scenario in which colleges have different application fees and the student has a finite monetary budget to spend on applications. Kapur \cite{kapur2022} shows that the college application problem with a knapsack constraint is NP-complete and provides a fully polynomial-time approximation scheme. Matroidal constraints also appear in real-world admissions markets: In the Korean admissions process, for example, the online application form contains three multiple-choice fields, labeled \emph{ga, na,} and \emph{da} for the first three letters of the Korean alphabet, which students use to indicate the colleges to which they wish to apply. Most schools appear only in one or two of the three fields. Therefore, students are restricted not only in the number of applications they can submit, but in the combinations of schools that may coincide in a feasible application portfolio. From a portfolio optimization perspective, this is a \emph{diversification constraint,} because its primary purpose is to prevent students from applying only to top-tier schools. It is not difficult to see that the set of possible portfolios a student can select in this system is a matroid.




% explicit risk aversion parameter
